alert tcp 1.1.1.1 any -> 10.0.0.1 80 ( msg:"MALWARE-BACKDOOR Asp.Trojan.Hafnium web shell upload attempt"; flow:to_server,established; file_data; content:"Request"; content:"eval(",within 300,fast_pattern; pcre:"/Request(?:\x2eForm)?[\x28\x5b][\x22\x27]\w+[\x22\x27][\x29\x5d]\x3b\s*var\s+\w+\s*=\s*(?:\w+[\x28\x5b]\d+[\x29\x5d](?:\s*\x2b\s*)?){6}\x3b\s*eval\x28/i"; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:57314; rev:1; )
alert tcp 1.1.1.1 any -> 10.0.0.1 80 ( msg:"MALWARE-BACKDOOR Asp.Trojan.Hafnium web shell upload attempt"; flow:to_server,established; file_data; content:"Request.Files[0].SaveAs(Server.MapPath(",fast_pattern,nocase; content:"runat=|22|server|22|",nocase; content:"Page_Load",within 100,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:57315; rev:1; )
alert tcp 1.1.1.1 any -> 10.0.0.1 80 ( msg:"MALWARE-BACKDOOR Asp.Trojan.Hafnium web shell upload attempt"; flow:to_server,established; file_data; content:"runat=|22|server|22|",nocase; content:"Page_Load",within 75,nocase; content:"eval",within 150; content:"Request",within 100,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:57316; rev:1; )
alert tcp 1.1.1.1 any -> 10.0.0.1 80 ( msg:"MALWARE-BACKDOOR Asp.Trojan.Hafnium web shell upload attempt"; flow:to_server,established; file_data; content:"runat=|22|server|22|",fast_pattern,nocase; content:"Page_Load",within 100,nocase; content:"System.IO.StreamWriter",within 100,nocase; content:"Request",within 100; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:57317; rev:1; )
alert tcp 1.1.1.1 any -> 10.0.0.1 80 ( msg:"MALWARE-BACKDOOR Asp.Trojan.Hafnium web shell upload attempt"; flow:to_server,established; file_data; content:"Page_Load",nocase; content:"System.IO.File.WriteAllBytes",within 100; content:"Convert.FromBase64String",within 100; content:"Request",within 75; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:57318; rev:1; )
alert tcp 1.1.1.1 any -> 10.0.0.1 80 ( msg:"MALWARE-BACKDOOR Asp.Trojan.Hafnium web shell upload attempt"; flow:to_server,established; file_data; content:"runat=|22|server|22|",fast_pattern,nocase; content:"Convert.ToBase64String"; content:"System.Security.Cryptography",within 75; content:"HttpContext.Current.Request",within 100; content:"System.Diagnostics.Process"; content:".Start",within 250; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:57319; rev:1; )
alert tcp 1.1.1.1 any -> 10.0.0.1 80 ( msg:"MALWARE-BACKDOOR Asp.Trojan.Hafnium web shell upload attempt"; flow:to_server,established; file_data; content:"System.Text.Encoding.Default.GetString(Convert.FromBase64String(StrTr(Request.Headers.Get",fast_pattern,nocase; content:"System.Net.Sockets"; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:57320; rev:1; )
alert tcp 1.1.1.1 any -> 10.0.0.1 80 ( msg:"MALWARE-BACKDOOR Asp.Trojan.Hafnium web shell upload attempt"; flow:to_server,established; file_data; content:"runat=|22|server|22|",fast_pattern,nocase; content:"Request.Headers.Get"; content:".Split(",within 100; content:"new IPEndPoint("; content:"new Socket(",within 250; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:57321; rev:1; )
